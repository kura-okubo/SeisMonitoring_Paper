<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Run examples · SeisMonitoring Paper</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SeisMonitoring Paper</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Index</a></li><li class="is-active"><a class="tocitem" href>Run examples</a><ul class="internal"><li><a class="tocitem" href="#How-to-run-the-projects"><span>How to run the projects</span></a></li><li><a class="tocitem" href="#Run-the-archived-casestudy"><span>Run the archived casestudy</span></a></li><li><a class="tocitem" href="#Development-environments"><span>Development environments</span></a></li></ul></li><li><a class="tocitem" href="../download_correlations/">Download CFs</a></li><li><a class="tocitem" href="../plot_figures_recipe/">Recipe of figures</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Run examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Run examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/kura-okubo/SeisMonitoring_Paper/blob/develop/docs/src/run_example.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Run-examples-of-processing"><a class="docs-heading-anchor" href="#Run-examples-of-processing">Run examples of processing</a><a id="Run-examples-of-processing-1"></a><a class="docs-heading-anchor-permalink" href="#Run-examples-of-processing" title="Permalink"></a></h1><p>The case studies used in the manuscript are followings:</p><table><tr><th style="text-align: right">id</th><th style="text-align: right">remove eq</th><th style="text-align: right">temporal/spectral normalization</th><th style="text-align: right">dv/v method</th><th style="text-align: right">reference period</th></tr><tr><td style="text-align: right">00</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">stretching</td><td style="text-align: right">2010-2022</td></tr><tr><td style="text-align: right">01</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">mwcs</td><td style="text-align: right">2010-2022</td></tr></table><p>You can download the dv/v datasheet from <a href="https://dasway.ess.washington.edu/shared/kokubo/parkfield_data/monitoring_stats_uwbackup_2010-2022.tar.gz"><code>monitoring_stats_uwbackup_2010-2022.tar.gz</code></a></p><p>In the early development of software tools using <a href="https://frontera-portal.tacc.utexas.edu">TACC FRONTERA</a>, we performed the following case studies for the data between 2002-2020 to investigate the effect of parameters associated with the process flow on the dv/v time history, which are archived as follows.</p><table><tr><th style="text-align: right">id</th><th style="text-align: right">remove eq</th><th style="text-align: right">temporal/spectral normalization</th><th style="text-align: right">dv/v method</th><th style="text-align: right">reference period</th></tr><tr><td style="text-align: right">02</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">stretching</td><td style="text-align: right">2010-2020</td></tr><tr><td style="text-align: right">03</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">mwcs</td><td style="text-align: right">2010-2020</td></tr><tr><td style="text-align: right">04</td><td style="text-align: right">yes</td><td style="text-align: right">spectral whitening + onebit</td><td style="text-align: right">stretching</td><td style="text-align: right">2010-2020</td></tr><tr><td style="text-align: right">05</td><td style="text-align: right">yes</td><td style="text-align: right">spectral whitening + onebit</td><td style="text-align: right">mwcs</td><td style="text-align: right">2010-2020</td></tr><tr><td style="text-align: right">06</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">stretching</td><td style="text-align: right">2006-2016</td></tr><tr><td style="text-align: right">07</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">stretching</td><td style="text-align: right">2007-2010</td></tr><tr><td style="text-align: right">08</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">stretching</td><td style="text-align: right">2017-2020</td></tr><tr><td style="text-align: right">09</td><td style="text-align: right">no</td><td style="text-align: right">no</td><td style="text-align: right">stretching</td><td style="text-align: right">2010-2020</td></tr><tr><td style="text-align: right">10</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">robust stuck + stretching</td><td style="text-align: right">2010-2020</td></tr><tr><td style="text-align: right">11</td><td style="text-align: right">yes</td><td style="text-align: right">no</td><td style="text-align: right">compute coda Q</td><td style="text-align: right">2010-2020</td></tr></table><div class="admonition is-info"><header class="admonition-header">Archived dv/v datasheets</header><div class="admonition-body"><p>We investigated the case studies listed above to check the effect of reference period, normalizations and stacking methods to the dv/v time history. Indeed, it only causes minor differences in dv/v and does not modify the conclusions. However, as we have updated the software tools even after the the jobs done in FRONTERA and extended the study period from 2020 to 2022, we keep those case studies as the archives here.   </p></div></div><p>The archived dv/v datasheets are available in <a href="."><code>monitoring_stats_TACCbackup.tar.gz</code></a> The plots of the comparison between the master data sheets and the case study on Frontera can be found in <a href="Others/dvvanalysis_onTACC"><code>Others/dvvanalysis_onTACC</code></a>,</p><h2 id="How-to-run-the-projects"><a class="docs-heading-anchor" href="#How-to-run-the-projects">How to run the projects</a><a id="How-to-run-the-projects-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-run-the-projects" title="Permalink"></a></h2><p>To execute the process flow, we first configure the init file, e.g. <code>Example/init_ex_download.jl</code>, to set the input and output paths as well as the process parameters.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The output directory is specified in the julia scripts as <code>project_outputdir</code>. We need disk space enough to store the raw and intermediate data (CCFs, stacked CorrData).</p></div></div><p>Then, we run the job using the <code>topo_multi_slurm_run.jl</code> and <code>topo_slurm_multi.slurm</code>. These work flow is summarized in the <a href="https://nbviewer.org/github/kura-okubo/SeisMonitoring_Example/blob/main/code/run_seismonitoring.ipynb">tutorial of SeisMonitoring.jl</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We performed the casestudy with Slurm Workload Manager in Frontera, while we run the job in workstation such that</p><pre><code class="nohighlight hljs">#!/bin/bash

timestamp=$(date +PDT-%Y-%m-%d-%H-%M-%S)
NPROCS=16

date &gt; log_$timestamp.txt
julia topo_multi_slurm_run_uwdata.jl  $NPROCS 2&gt;&amp;1 | tee -a log_$timestamp.txt
date &gt;&gt; log_$timestamp.txt</code></pre></div></div><p>Once you finished the processing of the stacking and the measurement of dv/v, run <code>SeisMonitoring.smstats_read_stretching/mwcs</code> as coded in <code>Utils/run_smstats.jl</code>. This gathers the output of dv/v measurement and dumps to the csv file.</p><h2 id="Run-the-archived-casestudy"><a class="docs-heading-anchor" href="#Run-the-archived-casestudy">Run the archived casestudy</a><a id="Run-the-archived-casestudy-1"></a><a class="docs-heading-anchor-permalink" href="#Run-the-archived-casestudy" title="Permalink"></a></h2><p>To conduct the archived casestudy listed in the table above, please initiate projects and run processes as following:</p><ol><li>Move to <code>Examples</code> and run <code>sh init_project_all.sh</code>.</li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>You can run from download data to stacking &amp; dv/v measurement in one project at once; However, in this repository we separately process them for the sake of simplicity.</p></div></div><ol><li>Go to <code>Examples</code> and run/submit jobs from download to stacking (see slurm batches to run jobs).</li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The batch files need to be manually prepared in each input directory. For the cross-correlation stage, use <code>Utils/make_slurmbatch_parallel.jl</code> to prepare the slurm batch files to parallelize cc process with time chunks. In Frontera, it takes <strong>~1.6 hours to complete all the cross-correlations (13 stations x 3 components x 18 years)</strong> using 21 nodes and 37 cores/node. Note that this computational time does not include the waiting time of the job&#39;s queue.</p></div></div><ol><li>Configure the paths and run <code>sh Utils/smstats_seismonitoring.sh</code> to compile the outputs into csv table.</li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The stacked CorrData has the measurements in its misc (<code>C.misc</code>). <code>run_smstats.jl</code> gathers the measurements from stacked corrdata and output in csv table for post processing.</p></div></div><h2 id="Development-environments"><a class="docs-heading-anchor" href="#Development-environments">Development environments</a><a id="Development-environments-1"></a><a class="docs-heading-anchor-permalink" href="#Development-environments" title="Permalink"></a></h2><p>We conducted the case study of the ambient seismic noise processing using <a href="https://frontera-portal.tacc.utexas.edu">TACC FRONTERA</a> and the local workstation (48cores) installed in <a href="https://denolle-lab.github.io">UW Denolle Lab</a>.</p><blockquote><p>Reference of FRONTERA: Dan Stanzione, John West, R. Todd Evans, Tommy Minyard, Omar Ghattas, and Dhabaleswar K. Panda. 2020. Frontera: The Evolution of Leadership Computing at the National Science Foundation. In Practice and Experience in Advanced Research Computing (PEARC ’20), July 26–30, 2020, Portland, OR, USA. ACM, New York, NY, USA, 11 pages. https://doi.org/10.1145/3311790.3396656</p></blockquote><p>We also used the <a href="https://www.rc.fas.harvard.edu/about/cluster-architecture/">FASRC Cannon cluster</a> supported by the FAS Division of Science Research Computing Group at Harvard University for the early development of the software tools.</p><p>We used the seismic data operated by the <a href="https://ncedc.org/hrsn/">High Resolution Seismic Network (HRSN)</a> doi:<a href="https://ncedc.org/bp_doi_metadata.html">10.7932/HRSN</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Index</a><a class="docs-footer-nextpage" href="../download_correlations/">Download CFs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 2 September 2023 12:59">Saturday 2 September 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
